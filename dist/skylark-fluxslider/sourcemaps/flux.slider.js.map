{"version":3,"sources":["flux.slider.js"],"names":["define","$","flux","slider","elem","opts","browser","init","supportsTransitions","window","console","error","_this","this","fx","element","transitions","push","options","extend","autoplay","delay","pagination","controls","captions","width","height","onTransitionEnd","newTrans","each","index","tran","t","compatible","requires3d","supports3d","compatibilityCheck","images","Array","imageLoadedCount","currentImageIndex","nextImageIndex","playing","container","appendTo","surface","bind","event","target","hasClass","location","data","imageContainer","css","position","overflow","min-height","image1","image2","add","top","left","find","found_img","imgClone","cloneNode","link","parent","is","attr","remove","i","length","image","Image","onload","finishedLoading","setupImages","src","preventDefault","start","next","direction","prev","setTimeout","focus","isPlaying","prototype","constructor","interval","setInterval","log","transition","stop","clearInterval","trans","showImage","setNextIndex","removeClass","margin","padding","text-align","li","display","margin-left","cursor","addClass","append","font-size","font-family","line-height","font-weight","color","text-decoration","background","z-index","nextButton","css3","border-radius","prevButton","right","captionBar","opacity","bottom","transition-property","transition-duration","box-sizing","prependTo","updateCaption","img1","getImage","css1","background-image","children","show","undefined","Math","floor","random","e","fallback","run","str","html","nextIndex","increment"],"mappings":"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","file":"../flux.slider.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./flux\"\n],function($,flux) {\n\tflux.slider = function(elem, opts) {\n\t\t// Setup the flux.browser singleton to perform feature detection\n\t\tflux.browser.init();\n\n\t\tif(!flux.browser.supportsTransitions)\n\t\t{\n\t\t\tif(window.console && window.console.error)\n\t\t\t\tconsole.error(\"Flux Slider requires a browser that supports CSS3 transitions\");\n\t\t}\n\n\t\tvar _this = this;\n\n\t\tthis.element = $(elem);\n\n\t\t// Make a list of all available transitions\n\t\tthis.transitions = [];\n\t\tfor(var fx in flux.transitions)\n\t\t\tthis.transitions.push(fx);\n\n\t\tthis.options = $.extend({\n\t\t\tautoplay: true,\n\t\t\ttransitions: this.transitions,\n\t\t\tdelay: 4000,\n\t\t\tpagination: true,\n\t\t\tcontrols: false,\n\t\t\tcaptions: false,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tonTransitionEnd: null\n\t\t}, opts);\n\n\t\t// Set the height/width if given [EXPERIMENTAL!]\n\t\tthis.height = this.options.height ? this.options.height\t: null;\n\t\tthis.width \t= this.options.width  ? this.options.width \t: null;\n\n\t\t// Filter out non compatible transitions\n\t\tvar newTrans = [];\n\t\t$(this.options.transitions).each(function(index, tran){\n\t\t\tvar t = new flux.transitions[tran](this),\n\t\t\t\tcompatible = true;\n\t\t\t\n\t\t\tif(t.options.requires3d && !flux.browser.supports3d)\n\t\t\t\tcompatible = false;\n\t\t\t\t\n\t\t\tif(t.options.compatibilityCheck)\n\t\t\t\tcompatible = t.options.compatibilityCheck();\n\n\t\t\tif(compatible)\n\t\t\t\tnewTrans.push(tran);\n\t\t});\t\t\n\n\t\tthis.options.transitions = newTrans;\n\n\t\tthis.images = new Array();\n\t\tthis.imageLoadedCount = 0;\n\t\tthis.currentImageIndex = 0;\n\t\tthis.nextImageIndex = 1;\n\t\tthis.playing = false;\n\n\n\t\tthis.container = $('<div class=\"fluxslider\"></div>').appendTo(this.element);\n\t\t\n\t\tthis.surface = $('<div class=\"surface\" style=\"position: relative\"></div>').appendTo(this.container);\n\t\t\n\t\t// Listen for click events as we may want to follow a link\n\t\tthis.container.bind('click', function(event) {\n\t\t\tif($(event.target).hasClass('hasLink'))\n\t\t\t\twindow.location = $(event.target).data('href');\n\t\t});\n\n\t\tthis.imageContainer = $('<div class=\"images loading\"></div>').css({\n\t\t\t'position': 'relative',\n\t\t\t'overflow': 'hidden',\n\t\t\t'min-height': '100px'\n\t\t}).appendTo(this.surface);\n\t\t\n\t\t// If the height/width is already set then resize the container\n\t\tif(this.width && this.height)\n\t\t{\n\t\t\tthis.imageContainer.css({\n\t\t\t\twidth: this.width+'px',\n\t\t\t\theight: this.height+'px'\n\t\t\t});\n\t\t}\n\n\t\t// Create the placeholders for the current and next image\n\t\tthis.image1 = $('<div class=\"image1\" style=\"height: 100%; width: 100%\"></div>').appendTo(this.imageContainer);\n\t\tthis.image2 = $('<div class=\"image2\" style=\"height: 100%; width: 100%\"></div>').appendTo(this.imageContainer);\n\n\t\t$(this.image1).add(this.image2).css({\n\t\t\t'position': 'absolute',\n\t\t\t'top': '0px',\n\t\t\t'left': '0px'\n\t\t});\n\t\t\n\t\t// Get a list of the images to use\n\t\tthis.element.find('img, a img').each(function(index, found_img){\n\t\t\tvar imgClone = found_img.cloneNode(false),\n\t\t\t\tlink = $(found_img).parent();\n\n\t\t\t// If this img is directly inside a link then save the link for later use\n\t\t\tif(link.is('a'))\n\t\t\t\t$(imgClone).data('href', link.attr('href'));\n\n\t\t\t_this.images.push(imgClone);\n\n\t\t\t// Remove the images from the DOM\n\t\t\t$(found_img).remove();\n\t\t});\n\t\t\n\t\t// Load the images afterwards as IE seems to load images synchronously\n\t\tfor(var i=0; i<this.images.length; i++) {\n\t\t\tvar image = new Image();\n\t\t\timage.onload = function() {\n\t\t\t\t_this.imageLoadedCount++;\n\n\t\t\t\t_this.width  = _this.width \t? _this.width  : this.width;\n\t\t\t\t_this.height = _this.height ? _this.height : this.height;\n\n\t\t\t\tif(_this.imageLoadedCount >= _this.images.length)\n\t\t\t\t{\n\t\t\t\t\t_this.finishedLoading();\n\t\t\t\t\t_this.setupImages();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Load the image to ensure its cached by the browser\n\t\t\timage.src = this.images[i].src;\n\t\t}\n\t\t\n\t\t// Catch when a transition has finished\n\t\tthis.element.bind('fluxTransitionEnd', function(event, data) {\n\t\t\t// If the slider is currently playing then set the timeout for the next transition\n\t\t\t// if(_this.isPlaying())\n\t\t\t// \t_this.start();\n\t\t\t\n\t\t\t// Are we using a callback instead of events for notifying about transition ends?\n\t\t\tif(_this.options.onTransitionEnd) {\t\t\t\t\t\n\t\t\t\tevent.preventDefault();\n\t\t\t\t_this.options.onTransitionEnd(data);\n\t\t\t}\n\t\t});\n\n\t\t// Should we auto start the slider?\n\t\tif(this.options.autoplay)\n\t\t\tthis.start();\n\t\t\t\n\t\t// Handle swipes\n\t\tthis.element.bind('swipeLeft', function(event){\n\t\t\t_this.next(null, {direction: 'left'});\n\t\t}).bind('swipeRight', function(event){\n\t\t\t_this.prev(null, {direction: 'right'});\n\t\t});\n\t\t\n\t\t// Under FF7 autoplay breaks when the current tab loses focus\n\t\tsetTimeout(function(){\n\t\t\t$(window).focus(function(){\n\t\t\t\tif(_this.isPlaying())\n\t\t\t\t\t_this.next();\n\t\t\t});\n\t\t}, 100);\n\t};\n\n\tflux.slider.prototype = {\n\t\tconstructor: flux.slider,\n\t\tplaying: false,\n\t\tstart: function() {\n\t\t\tvar _this = this;\n\t\t\tthis.playing = true;\n\t\t\tthis.interval = setInterval(function() {\n\t\t\t\tconsole.log('play');\n\t\t\t\t_this.transition();\n\t\t\t}, this.options.delay);\n\t\t},\n\t\tstop: function() {\n\t\t\tthis.playing = false;\n\t\t\tclearInterval(this.interval);\n\t\t\tthis.interval = null;\n\t\t},\n\t\tisPlaying: function() {\n\t\t\treturn this.playing;\n\t\t\t//return this.interval != null;\n\t\t},\n\t\tnext: function(trans, opts) {\n\t\t\topts = opts || {};\n\t\t\topts.direction = 'left';\n\t\t\tthis.showImage(this.currentImageIndex+1, trans, opts);\n\t\t},\n\t\tprev: function(trans, opts) {\n\t\t\topts = opts || {};\n\t\t\topts.direction = 'right';\n\t\t\tthis.showImage(this.currentImageIndex-1, trans, opts);\n\t\t},\n\t\tshowImage: function(index, trans, opts) {\n\t\t\tthis.setNextIndex(index);\n\t\t\t\n\t\t\t// Temporarily stop the transition interval\n\t\t\t//clearInterval(this.interval);\n\t\t\t//this.interval = null;\n\t\t\t\n\t\t\tthis.setupImages();\n\t\t\tthis.transition(trans, opts);\n\t\t},  \n\t\tfinishedLoading: function() {\n\t\t\tvar _this = this;\n\n\t\t\tthis.container.css({\n\t\t\t\twidth: this.width+'px',\n\t\t\t\theight: this.height+'px'\n\t\t\t});\n\n\t\t\tthis.imageContainer.removeClass('loading');\n\n\t\t\t// Should we setup a pagination view?\n\t\t\tif(this.options.pagination)\n\t\t\t{\n\t\t\t\t// TODO: Attach to touch events if appropriate\n\t\t\t\tthis.pagination = $('<ul class=\"pagination\"></ul>').css({\n\t\t\t\t\tmargin: '0px',\n\t\t\t\t\tpadding: '0px',\n\t\t\t\t\t'text-align': 'center'\n\t\t\t\t});\n\n\t\t\t\tthis.pagination.bind('click', function(event){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t_this.showImage($(event.target).data('index'));\n\t\t\t\t});\n\n\t\t\t\t$(this.images).each(function(index, image){\n\t\t\t\t\tvar li = $('<li data-index=\"'+index+'\">'+(index+1)+'</li>').css({\n\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t'margin-left': '0.5em',\n\t\t\t\t\t\t'cursor': 'pointer'\n\t\t\t\t\t}).appendTo(_this.pagination);\n\n\t\t\t\t\tif(index == 0)\n\t\t\t\t\t\tli.css('margin-left', 0).addClass('current');\n\t\t\t\t});\n\n\t\t\t\tthis.container.append(this.pagination);\n\t\t\t}\n\n\t\t\t// Resize\n\t\t\t$(this.imageContainer).css({\n\t\t\t\twidth: this.width+'px',\n\t\t\t\theight: this.height+'px'\n\t\t\t});\n\n\t\t\t$(this.image1).css({\n\t\t\t\twidth: this.width+'px',\n\t\t\t\theight: this.height+'px'\n\t\t\t});\n\n\t\t\t$(this.image2).css({\n\t\t\t\twidth: this.width+'px',\n\t\t\t\theight: this.height+'px'\n\t\t\t});\n\n\t\t\tthis.container.css({\n\t\t\t\twidth: this.width+'px',\n\t\t\t\theight: this.height+(this.options.pagination?this.pagination.height():0)+'px'\n\t\t\t});\n\t\t\t\n\t\t\t// Should we add prev/next controls?\n\t\t\tif(this.options.controls){\n\t\t\t\tvar css = {\n\t\t\t\t\tpadding: '4px 10px 10px',\n\t\t\t\t\t'font-size': '60px',\n\t\t\t\t\t'font-family': 'arial, sans-serif',\n\t\t\t\t\t'line-height': '1em',\n\t\t\t\t\t'font-weight': 'bold',\n\t\t\t\t\tcolor: '#FFF',\n\t\t\t\t\t'text-decoration': 'none',\n\t\t\t\t\tbackground: 'rgba(0,0,0,0.5)',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t'z-index': 2000\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tthis.nextButton = $('<a href=\"#\">»</a>').css(css).css3({\n\t\t\t\t\t'border-radius': '4px'\n\t\t\t\t}).appendTo(this.surface).bind('click', function(event){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t_this.next();\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.prevButton = $('<a href=\"#\">«</a>').css(css).css3({\n\t\t\t\t\t'border-radius': '4px'\n\t\t\t\t}).appendTo(this.surface).bind('click', function(event){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t_this.prev();\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tvar top = (this.height - this.nextButton.height())/2;\n\t\t\t\tthis.nextButton.css({\n\t\t\t\t\ttop: top+'px',\n\t\t\t\t\tright: '10px'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.prevButton.css({\n\t\t\t\t\ttop: top+'px',\n\t\t\t\t\tleft: '10px'\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t// Should we use captions?\n\t\t\tif(this.options.captions){\n\t\t\t\tthis.captionBar = $('<div class=\"caption\"></div>').css({\n\t\t\t\t\tbackground: 'rgba(0,0,0,0.6)',\n\t\t\t\t\tcolor: '#FFF',\n\t\t\t\t\t'font-size': '16px',\n\t\t\t\t\t'font-family': 'helvetica, arial, sans-serif',\n\t\t\t\t\t'text-decoration': 'none',\n\t\t\t\t\t'font-weight': 'bold',\n\t\t\t\t\tpadding: '1.5em 1em',\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t'z-index': 110,\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\tbottom: 0\n\t\t\t\t}).css3({\n\t\t\t\t\t'transition-property': 'opacity',\n\t\t\t\t\t'transition-duration': '800ms',\n\t\t\t\t\t'box-sizing': 'border-box'\n\t\t\t\t}).prependTo(this.surface);\n\t\t\t}\n\t\t\t\n\t\t\tthis.updateCaption();\n\t\t},\n\t\tsetupImages: function() {\n\t\t\tvar img1 = this.getImage(this.currentImageIndex),\n\t\t\t\tcss1 = {\n\t\t\t\t\t'background-image': 'url(\"'+img1.src+'\")',\n\t\t\t\t\t'z-index': 101,\n\t\t\t\t\t'cursor': 'auto'\n\t\t\t\t};\n\n\t\t\t// Does this image have an associated link?\n\t\t\tif($(img1).data('href'))\n\t\t\t{\n\t\t\t\tcss1.cursor = 'pointer';\n\t\t\t\tthis.image1.addClass('hasLink');\n\t\t\t\tthis.image1.data('href', $(img1).data('href'));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.image1.removeClass('hasLink');\n\t\t\t\tthis.image1.data('href', null);\n\t\t\t}\n\n\t\t\tthis.image1.css(css1).children().remove();\n\n\t\t\tthis.image2.css({\n\t\t\t\t'background-image': 'url(\"'+this.getImage(this.nextImageIndex).src+'\")',\n\t\t\t\t'z-index': 100\n\t\t\t}).show();\n\n\t\t\tif(this.options.pagination && this.pagination)\n\t\t\t{\n\t\t\t\tthis.pagination.find('li.current').removeClass('current');\n\t\t\t\t$(this.pagination.find('li')[this.currentImageIndex]).addClass('current');\n\t\t\t}\n\t\t},\n\t\ttransition: function(transition, opts) {\n\t\t\t// Allow a transition to be picked from ALL available transitions (not just the reduced set)\n\t        if(transition == undefined || !flux.transitions[transition])\n\t        {\n\t            // Pick a transition at random from the (possibly reduced set of) transitions\n\t            var index = Math.floor(Math.random()*(this.options.transitions.length));\n\t            transition = this.options.transitions[index];\n\t        }\n\t\t\t\n\t\t\tvar tran = null;\n\n\t\t\ttry {\n\t\t        tran = new flux.transitions[transition](this, $.extend(this.options[transition] ? this.options[transition] : {}, opts));\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\t// If an invalid transition has been provided then use the fallback (default is to just switch the image)\n\t\t\t\ttran = new flux.transition(this, {fallback: true});\n\t\t\t}\n\n\t        tran.run();\n\t\t\t\n\t        this.currentImageIndex = this.nextImageIndex;\n\t        this.setNextIndex(this.currentImageIndex+1);\n\t\t\tthis.updateCaption();\n\t\t},\n\t\tupdateCaption: function() {\n\t\t\tvar str = $(this.getImage(this.currentImageIndex)).attr('title');\n\t\t\tif(this.options.captions && this.captionBar)\n\t\t\t{\n\t\t\t\tif(str !== \"\")\n\t\t\t\t\tthis.captionBar.html(str);\n\t\t\t\t\t\n\t\t\t\tthis.captionBar.css('opacity', str === \"\" ? 0 : 1);\n\t\t\t}\n\t\t},\n\t\tgetImage: function(index) {\n\t\t\tindex = index % this.images.length;\n\n\t\t\treturn this.images[index];\n\t\t},\n\t\tsetNextIndex: function(nextIndex)\n\t\t{\n\t\t\tif(nextIndex == undefined)\n\t\t\t\tnextIndex = this.currentImageIndex+1;\n\n\t\t\tthis.nextImageIndex = nextIndex;\n\n\t\t\tif(this.nextImageIndex > this.images.length-1)\n\t\t\t\tthis.nextImageIndex = 0;\n\n\t\t\tif(this.nextImageIndex < 0)\n\t\t\t\tthis.nextImageIndex = this.images.length-1;\n\t\t},\n\t\tincrement: function() {\n\t\t\tthis.currentImageIndex++;\n\t\t\tif(this.currentImageIndex > this.images.length-1)\n\t\t\t\tthis.currentImageIndex = 0;\n\t\t}\n\t};\n\n\treturn flux.slider;\n});"]}